# Dovecot Configuration
# Generated by Ansible

# REQUIRED: Config version for Dovecot 2.x
!include_try /usr/share/dovecot/protocols.d/*.protocol
dovecot_config_version = 2.3

protocols = imap
listen = *

# SSL/TLS
ssl = yes
ssl_cert = </etc/ssl/lksn-ca/certs/mail-srv.crt
ssl_key = </etc/ssl/lksn-ca/private/mail-srv.key
ssl_ca = </etc/ssl/lksn-ca/certs/ca.crt

# Authentication
auth_mechanisms = plain login
disable_plaintext_auth = yes

# LDAP authentication
passdb {
  driver = ldap
  args = /etc/dovecot/dovecot-ldap.conf
}

userdb {
  driver = ldap
  args = /etc/dovecot/dovecot-ldap.conf
}

# Mail location
mail_location = maildir:~/Maildir

# Postfix SASL
service auth {
  unix_listener /var/spool/postfix/private/auth {
    mode = 0660
    user = postfix
    group = postfix
  }
}
