---
# Manual Configuration Validator
# Checks manually configured services and explains errors
# Usage: ansible-playbook validate-manual.yml

- name: "ğŸ” VALIDATE MANUAL CONFIGURATIONS"
  hosts: all_servers
  gather_facts: yes
  vars:
    validation_results: []
    
  tasks:
    - name: "ğŸ“‹ Display Validation Info"
      debug:
        msg: |
          â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
          ğŸ” MANUAL CONFIGURATION VALIDATOR
          â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
          
          Server: {{ inventory_hostname }}
          IP: {{ ansible_default_ipv4.address | default('N/A') }}
          
          This will validate your manual configurations and
          explain any errors found.
          
          â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
      tags: [always]

# ============================================================
# FIREWALL VALIDATION
# ============================================================
- name: "ğŸ”¥ VALIDATE FIREWALL (fw-srv)"
  hosts: firewall
  gather_facts: yes
  tasks:
    - name: "Include firewall validation"
      include_tasks: validation-tasks/validate-firewall.yml
  tags: [firewall]

# ============================================================
# DNS VALIDATION
# ============================================================
- name: "ğŸŒ VALIDATE DNS (int-srv)"
  hosts: internal
  gather_facts: yes
  tasks:
    - name: "Include DNS validation"
      include_tasks: validation-tasks/validate-dns.yml
  tags: [dns]

# ============================================================
# LDAP VALIDATION
# ============================================================
- name: "ğŸ“ VALIDATE LDAP (int-srv)"
  hosts: internal
  gather_facts: yes
  tasks:
    - name: "Include LDAP validation"
      include_tasks: validation-tasks/validate-ldap.yml
  tags: [ldap]

# ============================================================
# LDAP VALIDATION
# ============================================================
- name: "ğŸ“ VALIDATE LDAP (int-srv)"
  hosts: internal
  gather_facts: yes
  tasks:
    - name: "Include LDAP validation"
      include_tasks: validation-tasks/validate-ldap.yml
  tags: [ldap]

# ============================================================
# CA VALIDATION
# ============================================================
- name: "ğŸ” VALIDATE CA (int-srv)"
  hosts: internal
  gather_facts: yes
  tasks:
    - name: "Include CA validation"
      include_tasks: validation-tasks/validate-ca.yml
  tags: [ca]

# ============================================================
# DATABASE VALIDATION
# ============================================================
- name: "ğŸ’¾ VALIDATE DATABASE (int-srv)"
  hosts: internal
  gather_facts: yes
  tasks:
    - name: "Include database validation"
      include_tasks: validation-tasks/validate-database.yml
  tags: [database]

# ============================================================
# MAIL VALIDATION
# ============================================================
- name: "ğŸ“§ VALIDATE MAIL (mail-srv)"
  hosts: mail
  gather_facts: yes
  tasks:
    - name: "Include mail validation"
      include_tasks: validation-tasks/validate-mail.yml
  tags: [mail]

# ============================================================
# WEB CLUSTER VALIDATION
# ============================================================
- name: "ğŸŒ VALIDATE WEB CLUSTER (web-01, web-02)"
  hosts: webcluster
  gather_facts: yes
  tasks:
    - name: "Include web cluster validation"
      include_tasks: validation-tasks/validate-webcluster.yml
  tags: [web]

# ============================================================
# SUMMARY
# ============================================================
- name: "ğŸ“Š VALIDATION SUMMARY"
  hosts: localhost
  gather_facts: no
  tasks:
    - name: "Display summary"
      debug:
        msg: |
          â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
          ğŸ“Š VALIDATION COMPLETE
          â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
          
          Check the output above for any errors or warnings.
          
          âœ“ = Configuration correct
          âœ— = Configuration error (see explanation)
          âš  = Warning (not critical)
          
          â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
